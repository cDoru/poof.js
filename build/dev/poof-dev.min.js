!function(a,b){b["true"]=a;var c,d,e,f,g=g||{},h=h||{},i=i||{},j=j||{};g.exports=h||{},c={},c.__defineGetter__("VERSION",function(){return parseInt("0",10)}),c.__defineGetter__("REVISION",function(){return parseInt("4",10)}),c.__defineGetter__("BUILD",function(){return parseInt("4",10)}),c.__defineGetter__("VERSION_STRING",function(){return c.VERSION+"."+c.REVISION+"."+c.BUILD}),d={MAIN_CLASS_ATTRIBUTE_NAME:"data-main",CLASS_EXTENSION:".poof",ROOT:""},e=function(a){if(i.addEventListener)i.addEventListener("DOMContentLoaded",a,!1);else if(/KHTML|WebKit|iCab/i.test(j.userAgent))var b=setInterval(function(){/loaded|complete/i.test(i.readyState)&&(a(),clearInterval(b))},10);else h.onload=a},f=function(){var a,b,c,e=i.getElementsByTagName("script");for(a=0;a<e.length;++a)if(e[a].hasAttribute(d.MAIN_CLASS_ATTRIBUTE_NAME)&&(b=e[a].getAttribute(d.MAIN_CLASS_ATTRIBUTE_NAME),b.match(d.CLASS_EXTENSION+"$")))return d.ROOT=-1===b.indexOf("/")?"":b.substring(0,b.lastIndexOf("/")+1),c=H(b,function(){new c}),!0;return!1},e(function(){f()||console.warn("poof.js main class not found")}),g.exports.poof=c;var k,l,m,n,o,p,q,r,s,t,u,v=1,w=2,x=1,y=2,z=3,A=[{field:"static$",type:v},{field:"instance$",type:w}],B=[{field:"public$",type:x},{field:"protected$",type:y},{field:"private$",type:z}],C={ERROR_INTERFACE_MISSING_IMPLEMENTATION:"Missing implementation of instance method {prop} in definition of class {name}",ERROR_INTERFACE_ARGUMENTS_NUM:"Number of arguments in definition of method {prop} in definition of class {name} does not match the interface",ERROR_IMPLICIT_OVERRIDE:"Illegal attempt to implicitly override method {prop} originally defined in the base class by class {name}. Overriding has to be marked explicitly by defining the new implementation within the override$ tag.",ERROR_OVERRIDE_NOT_EXISTING:"Attempt to override method {prop} that has not been defined in {class}'s base class",ERROR_OVERRIDE_PROPERTY:"Illegal attempt to override property {prop} by class {name}. Only methods can be overridden.",ERROR_OVERRIDE_STATIC:"Illegal attempt to override a static property by class {name}",ERROR_PROPERTY_REDEFINE:"Illegal attempt to redefine property {prop} by class {name}. Property already defined in the base class.",ERROR_ACCESSIBILITY_1_2:"Illegal attempt to access protected property {prop} from outside {name}'s inheritance chain",ERROR_ACCESSIBILITY_1_3:"Illegal attempt to access private property {prop} from outside class {name}",ERROR_ACCESSIBILITY_2_2:"Illegal attempt to access protected static property {prop} from outside {name}'s inheritance chain",ERROR_ACCESSIBILITY_2_3:"Illegal attempt to access private static property {prop} from outside class {name}",ERROR_CONSTANT_MODIFICATION:"Illegal attempt to modify constant property {prop} on class {name}",ERROR_CONSTANT_METHOD:"Function cannot be constant. Evaluating definition of {prop} in definition of class {class}",ERROR_EXTEND_FINAL:"Invalid attempt to extend a final class {base} by class {name}",ERROR_EXTEND_CONSTRUCTOR_EXCEPTION:"Error during establishing inheritance for class {name}. Base class constructor has raised an exception when invoked with no arguments.",ERROR_EXTEND_INVALID_TYPE:"Base class for class {name} is of invalid type",ERROR_DEFINITION_INVALID_CLASS_NAME:"Invalid class name: {name}",ERROR_DEFINITION_INVALID_CLASS_TYPE:"Invalid class type specified for class {name}",ERROR_DEFINITION_INVALID_META:"Invalid or no meta object specified for class {name}",ERROR_DEFINITION_INVALID_DEFINITION:"Invalid or no definition specified for class {name}",ERROR_DEFINITION_DUPLICATE:"Illegal attempt to redefine property {prop} on class {name}",ERROR_INSTANTIATION_DIRECT_ABSTRACT:"Illegal attempt to directly instantiate an abstract class {name}",ERROR_INSTANTIATION_DIRECT_SINGLETON:"Illegal attempt to directly instantiate a Singleton class {name}"},D=1,E=!1,F=[];k={},l={},p=function(a,b){return function(){var c;return F.push(a),c=b.apply(this,arguments),F.pop(),c}},m=function(a){return 0!==F.length&&(a===F[F.length-1]||F[F.length-1]instanceof a.constructor)},n=function(a){return 0!==F.length&&a===F[F.length-1]},o=function(a,b){switch(b){case y:return m(a);case z:return n(a)}},q=function(a,b,c,d,e,f){switch(d){case x:f?(a.__defineGetter__(b,function(){return c}),a.__defineSetter__(b,function(){throw new Error(C.ERROR_CONSTANT_MODIFICATION.replace("{prop}",b).replace("{name}",name))})):a[b]=c;break;case y:case z:a.__defineGetter__(b,function(){if(o(a,d))return c;throw new Error(C["ERROR_ACCESSIBILITY_"+e.toString()+"_"+d.toString()].replace("{prop}",b).replace("{name}",name))}),f?a.__defineSetter__(b,function(){throw new Error(C.ERROR_CONSTANT_MODIFICATION.replace("{prop}",b).replace("{name}",name))}):a.__defineSetter__(b,function(c){if(!o(a,d))throw new Error(C["ERROR_ACCESSIBILITY_"+e.toString()+"_"+d.toString()].replace("{prop}",b).replace("{name}",name));a.__defineGetter__(b,function(){if(o(a,d))return c;throw new Error(C["ERROR_ACCESSIBILITY_"+e.toString()+"_"+d.toString()].replace("{prop}",b).replace("{name}",name))})})}},r=function(a,b,c,d,e,f,g){if(b!==c){if(!g&&void 0!==a[c])throw"function"==typeof a[c]?new Error(C.ERROR_IMPLICIT_OVERRIDE.replace("{prop}",c).replace("{name}",b)):new Error(C.ERROR_PROPERTY_REDEFINE.replace("{prop}",c).replace("{name}",b));if(c.toUpperCase()===c){if("function"==typeof d)throw new Error(C.ERROR_CONSTANT_METHOD.replace("{prop}",c).replace("{name}",b));q(a,c,d,e,f,!0)}else if("function"==typeof d)if(g){if(!a[c])throw new Error(C.ERROR_OVERRIDE_NOT_EXISTING.replace("{prop}",c).replace("{name}",b));var h=a[c];q(a,c,p(a,d),e,f,!1),a[c].super$=function(){return h.apply(this,arguments)}}else q(a,c,p(a,d),e,f,!1);else q(a,c,d,e,f,!1)}},s=function(a,b,c,d,e){if("function"!=typeof d)throw new Error(C.ERROR_OVERRIDE_PROPERTY.replace("{prop}",c).replace("{name}",b));r(a,b,c,d,e,w,!0)},t=function(a,b,c,d,e){var f,g,h,i,j,l,m,n,o,p,q,t=d&&d.extends$?d.extends$:null;if(d&&d.implements$)for(p=0;p<d.implements$.length;++p)for(q=0;q<d.implements$[p].length;++q){if(h=d.implements$[p][q],!e.instance$||!e.instance$.public$||"function"!=typeof e.instance$.public$[h.name])throw new Error(C.ERROR_INTERFACE_MISSING_IMPLEMENTATION.replace("{prop}",h.name).replace("{name}",c));if(e.instance$.public$[h.name].length!==h.length)throw new Error(C.ERROR_INTERFACE_ARGUMENTS_NUM.replace("{prop}",h.name).replace("{name}",c))}if(t){if("function"!=typeof t)throw new Error(C.ERROR_EXTEND_INVALID_TYPE.replace("{name}",c));if(t.final$)throw new Error(C.ERROR_EXTEND_FINAL.replace("{base}",t.name$).replace("{name}",c));try{b.prototype=new t}catch(w){throw new Error(C.ERROR_EXTEND_CONSTRUCTOR_EXCEPTION.replace("{name}",c))}}for(p=0;p<A.length;++p)if(m=A[p],l=[],e[m.field])for(q=0;q<B.length;++q)if(n=B[q],e[m.field][n.field])for(i in e[m.field][n.field])if("override$"===i){if(m.type===v)throw new Error(C.ERROR_OVERRIDE_STATIC.replace("{name}",c));for(j in e[m.field][n.field].override$)s(b.prototype,c,j,e[m.field][n.field][i][j],n.type)}else{if(-1!==l.indexOf(i))throw new Error(C.ERROR_DEFINITION_DUPLICATE);r(m.type===v?b:b.prototype,c,i,e[m.field][n.field][i],n.type,m.type),l.push(i)}if(e.instance$&&e.instance$.public$&&e.instance$.public$[c]?(f=function(){e.instance$.public$[c].apply(this,arguments)},t&&(f.super$=function(){t.apply(this,arguments)})):f=function(){},d.type$&&d.type$!==u.PUBLIC&&d.type$!==(u.PUBLIC|u.FINAL))if(d.type$===u.ABSTRACT)g=function(){throw new Error(C.ERROR_INSTANTIATION_DIRECT_ABSTRACT.replace("{name}",c))};else{if(d.type$!==u.SINGLETON&&d.type$!==(u.SINGLETON|u.FINAL))throw new Error(C.ERROR_DEFINITION_INVALID_CLASS_TYPE.replace("{name}",c));var x;g=function(){if(!E)throw new Error(C.ERROR_INSTANTIATION_DIRECT_SINGLETON.replace("{name}",c));f.apply(this,arguments)},b.__defineGetter__("instance",function(){return x||(E=!0,x=new g,E=!1),x})}else g=function(){f.apply(this,arguments)};o=!!(d.type$&&d.type$&u.FINAL),b.__defineGetter__("final$",function(){return o}),b.__defineGetter__("name$",function(){return c}),b.ready$=!0,k[a]=g},u=function(a,b,c){var d,e,f,g=!0;if("string"!=typeof a||0===a.length)throw new Error(C.ERROR_DEFINITION_INVALID_CLASS_NAME.replace("{name}",a));if("object"!=typeof b)throw new Error(C.ERROR_DEFINITION_INVALID_META.replace("{name}",a));if("object"!=typeof c)throw new Error(C.ERROR_DEFINITION_INVALID_DEFINITION.replace("{name}",a));if(b.extends$&&!b.extends$.ready$&&(g=!1),b.implements$)for(f=0;f<b.implements$.length;++f)if(!b.implements$[f].ready$){g=!1;break}return d=D++,e=function(){k[d].apply(this,arguments)},g?t(d,e,a,b,c):(k[d]=function(){throw new Error("Class "+a+" not ready.")},e.onReady$=function(a){"function"==typeof a&&(e.ready$?a():(l[d]=l[d]||[],l[d].push(a)))},I.registerDependend(d,e,a,b,c)),e},u.PUBLIC=1,u.ABSTRACT=2,u.SINGLETON=4,u.FINAL=8,g.exports.class$=u;var G=function(a,b){var c,d=[];if("string"!=typeof a||0===a.length)throw new Error("Invalid interface name "+a);for(c in b){if("function"!=typeof b[c])throw new Error("An interface can only define methods. Invalid property "+a+":"+c);d.push({name:c,length:b[c].length})}return d.ready$=!0,d};g.exports.interface$=G;var H,I;I={resourcesByPath:{},constructorsByPath:{},importTimeoutId:-1,queue:[],dependent:[],getResourceReference:function(a){return this.resourcesByPath[a]},createReference:function(a){switch(this.guessResourceType(a)){case"class":return this.createClassReference(a);case"script":break;case"image":break;case"other":return{}}},guessResourceType:function(a){return a.match(".+"+d.CLASS_EXTENSION+"$")?"class":a.match(".+\\.js$")?"script":a.match(".+\\.[jpg|jpeg|png]$")?"image":"other"},registerDependend:function(a,b,c,d,e){var f,g=[];if(d&&d.extends$&&!d.extends$.ready$&&g.push(d.extends$),d&&d.implements$)for(f=0;f<d.implements$.length;++f)d.implements$[f].ready$||g.push(d.implements$[f]);this.dependent.push({id:a,ref:b,name:c,definition:e,pending:g})},createClassReference:function(a){return this.constructorsByPath[a]=this.createTemporaryConstructor(),function(){I.constructorsByPath[a].apply(this,arguments)}},createTemporaryConstructor:function(){return function(){throw new Error("Class not ready yet.")}},add:function(a,b,c){this.queue.push({path:a,ref:b,callback:c})},resolveUrl:function(a){return-1===a.indexOf("/")?d.ROOT+a.split(d.CLASS_EXTENSION)[0].replace(/\./g,"/")+d.CLASS_EXTENSION:a},load:function(a){switch(this.guessResourceType(a)){case"class":console.log("loading class");case"script":console.log("loading script",a);break;case"image":break;case"other":}},run:function(){var a=this;clearTimeout(this.importTimeoutId),this.importTimeoutId=setTimeout(function(){a.importNext()},1)},importNext:function(){var a,b,c=this;0!==this.queue.length&&(a=this.queue.splice(0,1)[0],b=function(){c.onImportComplete(),"function"==typeof a.callback&&a.callback()},this.load(a.path,b))},onImportComplete:function(){}},H=function(a,b){var c=I.getResourceReference(a);return c||(c=I.createReference(a),I.add(a,c,b),I.run()),c},g.exports.import$=H}({},function(){return this}());